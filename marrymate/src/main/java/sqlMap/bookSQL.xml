<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.marry.book">
	<select id="cateList" parameterType="String" resultType="com.marry.company.model.CompanyDTO">
		select
			*
		from
			company
		where
			kind=#{filterCate} and clevel=1 and blind=0
		order by
			cname asc
	</select>
	<select id="orderList" parameterType="com.marry.book.model.FilterDTO" resultType="com.marry.company.model.CompanyDTO">
		select
			*
		from
			company
		where
			kind=#{filterCate} and clevel=1 and blind=0
		order by
			<if test="filterOrder=='이름순'">
	 			cname asc, cidx desc
	 		</if>
	 		<if test="filterOrder=='조회순'">
	 			watch desc, cidx desc
	 		</if>
	 		<if test="filterOrder=='낮은가격순'">
	 			pay asc, cidx desc
	 		</if>
	 		<if test="filterOrder=='높은가격순'">
	 			pay desc, cidx desc
	 		</if>
	</select>
	<select id="addCart" parameterType="Integer" resultType="com.marry.company.model.CompanyDTO">
		select
			*
		from
			company
		where
			cidx=#{cidx}
	</select>
	<select id="searchList" parameterType="com.marry.book.model.FilterDTO" resultType="com.marry.company.model.CompanyDTO">
		select
			company.cidx, kind, cname, sido, sigungu, pay, clevel, watch, blind, img
		from
			company, book_time
		where
			company.cidx=book_time.cidx
		and
			clevel=1 and blind=0
		and
			(cname like #{filterText} or sido like #{filterText} or sigungu like #{filterText})
		and
			yoil like #{filterDate}
		and
			sido like #{filterSido}
		and
			pay <![CDATA[>=]]> #{filterPriceMin} and pay <![CDATA[<=]]> #{filterPriceMax}
		and
			kind=#{filterCate}
		group by
			company.cidx, kind, cname, sido, sigungu, pay, clevel, watch, blind, img
		order by
			cname asc, company.cidx desc
	</select>
</mapper>